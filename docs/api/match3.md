# Match-3 логика (`game/match3`)

Папка `game/match3/` содержит чистую (в основном) логику игры match-3.

## Публичные функции (`game/match3/logic.ts`)

### `initBoard(board)`
Назначение:
- Заполняет поле случайными тайлами.
- Пытается избежать стартовых матчей (до 40 попыток).

Побочные эффекты:
- **Мутирует** переданный объект `board` (заполняет `board.tiles`).

### `attemptSwap(board, a, b)`
Назначение:
- Пытается выполнить обмен двух позиций.
- Возвращает `{ valid, board }`.

Примечание:
- Если матчей нет, обмен всё равно разрешён, когда **обе** клетки содержат `special`.

### `resolveBoard(board, chain=1)`
Назначение:
- Ищет матчи, удаляет совпадения, применяет гравитацию и refill.
- Генерирует специальные тайлы при определённых условиях.

Возвращает:
- `ResolveResult | null`.

Побочные эффекты:
- **Мутирует** `board`.

### `peekMatches(board)`
Назначение:
- Возвращает уникальный список позиций, которые сейчас образуют матч.
- Используется для preview/анимаций.

### `activateSpecial(board, pos)`
Назначение:
- Активирует специальный тайл (`rocketH`, `rocketV`, `lightning`, `bomb`).

### `activateCombinedSpecial(board, aPos, bPos)`
Назначение:
- Активирует комбинированный эффект при swap двух специальных тайлов.

## См. также
- Типы данных: `game/match3/types.ts`.
- Константы и утилиты: `game/match3/constants.ts`, `game/match3/utils.ts`.
